{
  "openapi": "3.0.0",
  "paths": {
    "/": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/ws-test.html": {
      "get": {
        "operationId": "AppController_getTestPage",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/health": {
      "get": {
        "operationId": "AppController_getHealth",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/auth/register": {
      "post": {
        "description": "Create account with email and password",
        "operationId": "AuthController_register",
        "parameters": [],
        "responses": {
          "201": {
            "description": "User registered successfully"
          },
          "400": {
            "description": "Email and password are required"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Register new user",
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/verify-email": {
      "get": {
        "operationId": "AuthController_verifyEmail",
        "parameters": [
          {
            "name": "token",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/login": {
      "post": {
        "description": "Authenticate with email and password",
        "operationId": "AuthController_login",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Login successful, returns JWT token"
          },
          "401": {
            "description": "Invalid credentials"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Login user",
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/forgot-password": {
      "post": {
        "operationId": "AuthController_forgotPassword",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/reset-password": {
      "get": {
        "operationId": "AuthController_resetPasswordPage",
        "parameters": [
          {
            "name": "token",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      },
      "post": {
        "operationId": "AuthController_resetPassword",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/me": {
      "get": {
        "operationId": "AuthController_me",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/guest": {
      "post": {
        "operationId": "AuthController_guest",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/profile": {
      "patch": {
        "operationId": "AuthController_updateProfile",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProfileDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/public-profile/{userId}": {
      "get": {
        "operationId": "AuthController_getPublicProfile",
        "parameters": [
          {
            "name": "userId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/link-email": {
      "post": {
        "operationId": "AuthController_linkEmail",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/stats": {
      "get": {
        "operationId": "AuthController_getStats",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/audit": {
      "get": {
        "operationId": "AuthController_getAudit",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/auth/resend-verification": {
      "post": {
        "operationId": "AuthController_resendVerification",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Authentication"
        ]
      }
    },
    "/wallet": {
      "get": {
        "description": "Returns current balance and frozen amount",
        "operationId": "WalletsController_me",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Balance retrieved"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get wallet balance",
        "tags": [
          "Wallets"
        ]
      }
    },
    "/wallet/reset-frozen": {
      "post": {
        "description": "Return frozen stake to available balance",
        "operationId": "WalletsController_resetFrozen",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Frozen balance returned"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Reset frozen balance",
        "tags": [
          "Wallets"
        ]
      }
    },
    "/wallet/admin/reset-frozen": {
      "post": {
        "description": "Admin can reset frozen balance for any user",
        "operationId": "WalletsController_adminResetFrozen",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Admin: reset frozen balance",
        "tags": [
          "Wallets"
        ]
      }
    },
    "/wallet/reconcile": {
      "get": {
        "description": "Compare actual balance with expected based on game history",
        "operationId": "WalletsController_reconcile",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reconciliation data"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Reconcile balance",
        "tags": [
          "Wallets"
        ]
      }
    },
    "/matchmaking/quickplay": {
      "post": {
        "description": "Join queue for Rock Paper Scissors match",
        "operationId": "MatchmakingController_quickplay",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Joined queue or match created"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Join matchmaking queue",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/match/{id}/audit": {
      "get": {
        "description": "Returns financial audit for match",
        "operationId": "MatchmakingController_audit",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get match audit log",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/ticket/{id}": {
      "get": {
        "operationId": "MatchmakingController_ticket",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/ticket/{id}/fallback": {
      "post": {
        "operationId": "MatchmakingController_fallback",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/match/{id}": {
      "get": {
        "description": "Returns match state by ID",
        "operationId": "MatchmakingController_match",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get match details",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/match/{id}/move": {
      "post": {
        "description": "Submit ROCK, PAPER or SCISSORS move",
        "operationId": "MatchmakingController_move",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitMoveDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Submit move",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/cleanup-orphaned": {
      "post": {
        "operationId": "MatchmakingController_cleanupOrphaned",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/test-create-orphaned": {
      "post": {
        "operationId": "MatchmakingController_testCreateOrphaned",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/active": {
      "get": {
        "description": "Check if user is in queue or active match",
        "operationId": "MatchmakingController_getActiveState",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get active state",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/online": {
      "get": {
        "operationId": "MatchmakingController_getOnlineCount",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/history": {
      "get": {
        "description": "Returns user's match history",
        "operationId": "MatchmakingController_getMatchHistory",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get match history",
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/matchmaking/test/force-match": {
      "post": {
        "operationId": "MatchmakingController_forceMatch",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "tags": [
          "Matchmaking"
        ]
      }
    },
    "/avatars": {
      "get": {
        "operationId": "AvatarsController_getAvatarsList",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Avatars"
        ]
      }
    },
    "/avatars/{filename}": {
      "get": {
        "operationId": "AvatarsController_getAvatar",
        "parameters": [
          {
            "name": "filename",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Avatars"
        ]
      }
    },
    "/admin/users": {
      "get": {
        "description": "List all users with pagination",
        "operationId": "AdminController_getUsers",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Users list returned"
          },
          "403": {
            "description": "Admin access required"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get users list",
        "tags": [
          "Admin"
        ]
      }
    },
    "/admin/users/{id}": {
      "get": {
        "description": "Get detailed info about specific user",
        "operationId": "AdminController_getUserDetails",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User details returned"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get user details",
        "tags": [
          "Admin"
        ]
      }
    },
    "/admin/users/balance": {
      "post": {
        "description": "Add or subtract balance from user wallet. Positive amount = add, negative = subtract.",
        "operationId": "AdminController_updateBalance",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Balance updated successfully"
          },
          "400": {
            "description": "Invalid amount or insufficient balance"
          },
          "403": {
            "description": "Admin access required"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Update user balance",
        "tags": [
          "Admin"
        ]
      }
    },
    "/admin/stats": {
      "get": {
        "description": "Overview statistics for admin panel",
        "operationId": "AdminController_getStats",
        "parameters": [
          {
            "name": "authorization",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Stats returned"
          }
        },
        "security": [
          {
            "JWT-auth": []
          }
        ],
        "summary": "Get admin dashboard stats",
        "tags": [
          "Admin"
        ]
      }
    },
    "/leaderboard": {
      "get": {
        "description": "Returns top players sorted by specified category",
        "operationId": "LeaderboardController_getLeaderboard",
        "parameters": [
          {
            "name": "category",
            "required": false,
            "in": "query",
            "description": "Sort category",
            "schema": {
              "enum": [
                "wins",
                "winRate",
                "profit",
                "streak",
                "biggestWin"
              ],
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Number of results (default: 10, max: 100)",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "description": "Offset for pagination (default: 0)",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Leaderboard entries"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get leaderboard by category",
        "tags": [
          "Leaderboard"
        ]
      }
    },
    "/leaderboard/global": {
      "get": {
        "description": "Returns top players from all categories for main page",
        "operationId": "LeaderboardController_getGlobalLeaderboard",
        "parameters": [
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Number of results per category (default: 5)",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Leaderboard by all categories"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get global leaderboard",
        "tags": [
          "Leaderboard"
        ]
      }
    },
    "/leaderboard/me": {
      "get": {
        "description": "Returns authenticated user's rank in leaderboard",
        "operationId": "LeaderboardController_getMyPosition",
        "parameters": [
          {
            "name": "category",
            "required": false,
            "in": "query",
            "description": "Category",
            "schema": {
              "enum": [
                "wins",
                "winRate",
                "profit",
                "streak",
                "biggestWin"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User position"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get current user position",
        "tags": [
          "Leaderboard"
        ]
      }
    },
    "/leaderboard/user/{userId}": {
      "get": {
        "description": "Returns specific user's position",
        "operationId": "LeaderboardController_getUserPosition",
        "parameters": [
          {
            "name": "userId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "category",
            "required": false,
            "in": "query",
            "description": "Category",
            "schema": {
              "enum": [
                "wins",
                "winRate",
                "profit",
                "streak",
                "biggestWin"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User position"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get user position",
        "tags": [
          "Leaderboard"
        ]
      }
    },
    "/leaderboard/categories": {
      "get": {
        "operationId": "LeaderboardController_getCategories",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of categories"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get available leaderboard categories",
        "tags": [
          "Leaderboard"
        ]
      }
    }
  },
  "info": {
    "title": "WagerPlay API",
    "description": "Rock Paper Scissors betting game API",
    "version": "1.0.0",
    "contact": {}
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "User registration and login"
    },
    {
      "name": "Wallets",
      "description": "Balance and transactions"
    },
    {
      "name": "Matchmaking",
      "description": "Game queue and matches"
    },
    {
      "name": "Statistics",
      "description": "User stats and history"
    }
  ],
  "servers": [],
  "components": {
    "securitySchemes": {
      "JWT-auth": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http",
        "name": "JWT",
        "description": "Enter JWT token",
        "in": "header"
      }
    },
    "schemas": {
      "UpdateProfileDto": {
        "type": "object",
        "properties": {}
      },
      "SubmitMoveDto": {
        "type": "object",
        "properties": {}
      }
    }
  }
}